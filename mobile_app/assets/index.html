<!DOCTYPE HTML>
<!--<html manifest="offline.appcache" lang="en">-->
<html lang="en">    
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Betes Log - Your Diabetes Log Book</title>
		<link rel="stylesheet" href="css/vendor/bootstrap.min.css" />
		<link rel="stylesheet" href="css/vendor/bootstrap-responsive.min.css" />
		<link rel="stylesheet" href="css/vendor/font-awesome.css" />
		<link rel="stylesheet" href="css/graphs.css" />
	</head>
	  
	<body>
		<section id="app-nav">
				
		</section>
		<div class="container">
			<div id="app" class="row-fluid">
				<div id="modal-dialog"></div>
				<section id="main">			
				</section>
			</div>
		</div>
		<!-- App Source -->
		<script type="text/template" id="nav-template">
		<div class="navbar navbar-inverse">
			<div class="navbar-inner">
				<a class="brand" href="#"><i class="icon-tint"></i> Betes Log</a>
				
                <div class="pull-right">
                    <%if(authenticated) {%>
                        Hi <%= name%>
						<button id="logout" class="btn btn-primary"> Logout</button>
                    <%} else { %>
                        <button id="login" class="btn btn-primary"> Login</button>
                    <%}%>    
				</div>
			</div>
		</div>
		</script>
		<script type="text/template" id="item-template">
            <td><% if(resultDate) { %> <a class="update" href="#"><i class="icon-edit"></i> <%= resultDate.substring(0, 10) %> @ <%= name %></a><% } %></td>
			<td><% if(bsLevel>0) { %> <%= bsLevel %> mmol <% } %><% if(insulinAmount>0) { %>and <%= insulinAmount %> u
			<% } else if(exerciseDuration>0) { %> <%= exerciseDuration %> mins @ <%= exerciseIntensity %> <% } %></td>
			
		</script>
		<script type="text/template" id="edit-item-template">
		<div id="edit-entry" class="modal hide fade">
				<div class="modal-header">
					<h3 id="myModalLabel">Editing Result</h3>
				</div>
				<div class="modal-body">
					<h4>Basics</h4>							
					<select  id="edit-entry-name" autofocus>
						<option <%if (name=="Waking") {%>selected<%}%> value="Waking">Waking</option>
						<option <%if (name=="Breakfast") {%>selected<%}%> value="Breakfast">Breakfast</option>
						<option <%if (name=="Mid-Morning") {%>selected<%}%> value="Mid-Morning">Mid-Morning</option>
						<option <%if (name=="Lunch") {%>selected<%}%> value="Lunch">Lunch</option>
						<option <%if (name=="Mid-Afternoon") {%>selected<%}%> value="Mid-Afternoon">Mid-Afternoon</option>
						<option <%if (name=="Dinner") {%>selected<%}%> value="Dinner">Dinner</option>
						<option <%if (name=="Evening") {%>selected<%}%> value="Evening">Evening</option>
						<option <%if (name=="Bed") {%>selected<%}%> value="Bed">Bed</option>
						<option <%if (name=="Other") {%>selected<%}%> value="Other">Other</option>
					</select>
					<input type="text" class="when-picker" name="when-picker" id="edit-entry-date" value="<%= resultDate %>">
					<input type="text" id="edit-entry-level" value="<%= bsLevel %>">
					<input type="text" id="edit-entry-insulin" value="<%= insulinAmount %>">
					<h4>exercise</h4>
					<input type="text" id="edit-entry-exercise-duration" value="<%= exerciseDuration %>">				
					<select  id="edit-entry-exercise-intensity">
						<option <%if (exerciseIntensity=="") {%>selected<%}%> value="">NA</option>
						<option <%if (exerciseIntensity=="Easy") {%>selected<%}%> value="Easy">Easy</option>
						<option <%if (exerciseIntensity=="Easy-Moderate") {%>selected<%}%> value="Easy-Moderate">Easy-Moderate</option>
						<option <%if (exerciseIntensity=="Moderate") {%>selected<%}%> value="Moderate">Moderate</option>
						<option <%if (exerciseIntensity=="Moderate-Intense") {%>selected<%}%> value="Moderate-Intense">Moderate-Intense</option>
						<option <%if (exerciseIntensity=="Intense") {%>selected<%}%> value="Intense">Intense</option>
					</select>
					<h4>Labels</h4>
					<input class="span12" type="text" id="edit-entry-labels" value="<%= labels %>">
					<h4>Comments</h4>
					<textarea class="span12" rows="3" id="edit-entry-comments"><%= comments %></textarea>				
			
				</div>
				<div class="modal-footer">
					<button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
					<button class="btn btn-primary save-edit">Save</button>
				</div>
		</div>
		</script>
		<script type="text/template" id="add-item-template">
		<div id="add-entry-dialog" class="modal hide fade">
			<div class="modal-header">
				<h3>Add a new log book entry</h3>
			</div>
			<div class="modal-body">
				<label for="entry-name">Basics</label>
				<select id="entry-name" autofocus>
					<option value="Waking">Waking</option>
					<option value="Breakfast">Breakfast</option>
					<option value="Lunch">Lunch</option>
					<option value="Dinner">Dinner</option>
					<option value="Bed">Bed</option>
                    <option value="Mid-Morning">Mid-Morning</option>
                    <option value="Mid-Afternoon">Mid-Afternoon</option>
                    <option value="Evening">Evening</option>
					<option value="Other">Other</option>
				</select>
                
				<input type="text" name="entry-date" id="entry-date">
				<input type="text" id="entry-level" placeholder="Your Blood Sugar">
				<input type="text" id="entry-insulin" placeholder="Insulin Given">
                <label for="entry-exercise-duration">exercise</label>
				<input type="text" id="entry-exercise-duration" placeholder="exercise duration?">				
				<select id="entry-exercise-intensity">
					<option value="">NA</option>
					<option value="Easy">Easy</option>
					<option value="Easy-Moderate">Easy-Moderate</option>
					<option value="Moderate">Moderate</option>
					<option value="Moderate-Intense">Moderate-Intense</option>
					<option value="Intense">Intense</option>
				</select>
				<label for="entry-labels">Labels</label>
				<input class="span12" type="text" id="entry-labels" placeholder="e.g. sickday, traveling (comma seperated)">
				<label for="entry-comments">Comments</label>
				<textarea class="span12" rows="3" id="entry-comments" placeholder="General Comments"></textarea>				
			</div>
			<div class="modal-footer">
				<button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
				<button class="btn btn-primary add-entry">Save</button>
			</div>
		</div>
		</script>

		<script type="text/template" id="logbook-template">
            
			<ul class="nav nav-tabs" id="myTab">
				<li class="active"><a href="#logbook" data-toggle="tab">Logbook</a></li>
                <li><a href="#insights-graph" data-toggle="tab">Insights</a></li>
			</ul>
		       
			<div class="tab-content">                
				<div class="tab-pane active" id="logbook">
				<div class="btn-toolbar">
					<div class="btn-group">
						<button class="btn btn-primary add-all">Add New Event</button>
					</div>
					<div class="btn-group" data-toggle="buttons-radio">
                                <button class="btn show-today">Today</button>
                                <button class="btn show-yesterday">Yesterday</button>
                                <button class="btn show-seven">Last 7</button>
                    </div>
					</div>	
					<div class="input-prepend input-append">
								<span class="add-on">Filter Events</span>
								<input type="text" placeholder="e.g. 'dinner' or 'sickday'" class="filter-logbook" >
                                <a id="filter-logbook-popover" href="#" class="btn" data-toggle="popover" title="help" data-content="And here's some amazing content. It's very engaging. right?" data-original-title="A Title">?</a>
                    </div>
					
					
					<div id="modal-item"></div>

					<table class="table table-bordered table-condensed">
						<thead>
						  <tr>
						    <th style="width:30%">When</th>
						    <th style="width:70%">What</th>
						  </tr>
						</thead>
						<tbody id="events-list">
						</tbody>
					</table>
                    
				</div>
                <div class="tab-pane" id="insights-graph">
                    <div>
                        <div class="btn-group" data-toggle="buttons-radio">
                            <button class="btn show-today">Today</button>
                            <button class="btn show-yesterday">Yesterday</button>
                            <button class="btn show-seven">Last 7</button>
                        </div>
                    </div>
                    <table class="table table-bordered">
                        <caption>Quick insights into your diabetes</caption>
                        <thead>
                            <tr>
                                <th>Tests</th>
                                <th>Lows</th>
                                <th>Highs</th>
                                <th>Exercise</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="badge badge-success">4</span></td>    
                                <td><span class="badge badge-warning">1</span></td>
                                <td><span class="badge badge-important">10</span></td>
                                <td><span class="badge badge-success">120 mins</span></td>
                            </tr>
                        </tbody>
                    </table>
				</div>
			</div>
					
		</script>			
		<script type="text/template" id="goal-template">
			<td><% if(bsLowerRange) { %> <%= bsLowerRange %> <% } %> - <% if(bsUpperRange) { %> <%= bsUpperRange %> <% } %></td>
			<td><% if(bsFrequency) { %> <%= bsFrequency %> <% } %></td>
			<td><% if(exerciseDuration) { %> <%= exerciseDuration %> <% } %></td>
			<td><% if(exerciseFrequency) { %> <%= exerciseFrequency %> <% } %></td>			
			<td><% if(longTermGoal) { %> <%= longTermGoal %> <% } %></td>
			<td><% if(longTermGoalDate) { %> <%= longTermGoalDate %> <% } %></td>
			<td><a class="btn btn-link update-goals" href="#"><i class="icon-edit icon-large"></i></a><a class="btn btn-link delete-goals" href="#"><i class="icon-trash  icon-large"></i></a></td>
		</script>
		<script type="text/template" id="add-goal-template">
		<div id="add-goal-dialog" class="modal hide fade">
			<div class="modal-header">
				<h3>Add a new set of goals</h3>
			</div>
			<div class="modal-body">
				<p class="lead">Testing Goals</p>
				<p>Set your goals for testing so you can track them over time.</p>
				<div class="control-group">
					<label class="control-label" for="goal-bs-lower">Range</label>
					<div class="controls">
						<input type="number" id="goal-bs-lower" placeholder="lower" >
						<input type="number" id="goal-bs-upper" placeholder="upper" >
					</div>
				</div>
				<div class="control-group">
					<label class="control-label" for="goal-bs-lower">Frequency</label>
					<div class="controls">
						<input type="number" id="goal-bs-frequency" placeholder="times per day" > per/day
					</div>
				</div>				
				<p class="lead">exercise Goals</p>						
				<p>Set your goals for how much and how often you would like to exercise so you can this over time.</p>
				<div class="control-group">
					<label class="control-label" for="goal-exercise-duration">How Long</label>
					<div class="controls">
						<input type="number" id="goal-exercise-duration" placeholder="mins per day" > mins
					</div>
				</div>
				<div class="control-group">
					<label class="control-label" for="goal-exercise-frequency">How Often</label>
					<div class="controls">
						<input type="number" id="goal-exercise-frequency" placeholder="times per week" > per/wk
					</div>
				</div>
				<p class="lead">Long Term Goals</p>
				<div class="control-group">
					<label class="control-label" for="goal-long-term">Goal</label>
					<div class="controls">
						<textarea id="goal-long-term" />	
					</div>
				</div>
				<div class="control-group">
					<label class="control-label" for="goal-long-term">By When</label>
					<div class="controls">
						<input type="date" id="goal-long-term-date" >	
					</div>
				</div>			
			</div>
			<div class="modal-footer">
				<button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
				<button class="btn btn-primary add-goal">Add</button>
			</div>
		</div>
		</script>
		<script type="text/template" id="edit-goal-template">
		<div id="edit-goal-dialog" class="modal hide fade">
			<div class="modal-header">
				<h3>Edit goals</h3>
			</div>
			<div class="modal-body">
				<p class="lead">Testing Goals</p>
				<p>Set your goals for testing so you can track them over time.</p>
				<div class="control-group">
					<label class="control-label" for="goal-bs-lower">Range</label>
					<div class="controls">
						<input type="number" id="goal-bs-lower" placeholder="lower" <% if(bsLowerRange) { %> value="<%= bsLowerRange %>" <% } %>>
						<input type="number" id="goal-bs-upper" placeholder="upper" <% if(bsUpperRange) { %> value="<%= bsUpperRange %>" <% } %>>
					</div>
				</div>
				<div class="control-group">
					<label class="control-label" for="goal-bs-lower">Frequency</label>
					<div class="controls">
						<input type="number" id="goal-bs-frequency" placeholder="times per day" <% if(bsFrequency) { %> value="<%= bsFrequency %>" <% } %>> per/day
					</div>
				</div>				
				<p class="lead">exercise Goals</p>						
				<p>Set your goals for how much and how often you would like to exercise so you can this over time.</p>
				<div class="control-group">
					<label class="control-label" for="goal-exercise-duration">How Long</label>
					<div class="controls">
						<input type="number" id="goal-exercise-duration" placeholder="mins per day" <% if(exerciseDuration) { %> value="<%= exerciseDuration %>" <% } %>> mins
					</div>
				</div>
				<div class="control-group">
					<label class="control-label" for="goal-exercise-frequency">How Often</label>
					<div class="controls">
						<input type="number" id="goal-exercise-frequency" placeholder="times per week" <% if(exerciseFrequency) { %> value="<%= exerciseFrequency %>" <% } %>> per/wk
					</div>
				</div>
				<p class="lead">Long Term Goals</p>
				<div class="control-group">
					<label class="control-label" for="goal-long-term">Goal</label>
					<div class="controls">
						<textarea class="span6" id="goal-long-term" <% if(longTermGoal) { %> value="<%= longTermGoal %>" <% } %>/>	
					</div>
				</div>
				<div class="control-group">
					<label class="control-label" for="goal-long-term">By When</label>
					<div class="controls">
						<input type="date" id="goal-long-term-date" <% if(longTermGoalDate) { %> value="<%= longTermGoalDate %>" <% } %>>	
					</div>
				</div>			
			</div>
			<div class="modal-footer">
				<button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
				<button class="btn btn-primary add-goal">Add</button>
			</div>
		</div>
		</script>
		<script type="text/template" id="account-template">
		<ul class="nav nav-tabs" id="user-tabs">
            <li><a href="#user-account-tab" data-toggle="tab">Account</a></li>
			<li><a href="#user-goals-tab" data-toggle="tab">Goals</a></li>	
		</ul>
		<div class="tab-content">
			<div class="tab-pane" id="user-goals-tab">
				<div class="row-fluid">
					<form class="form-inline">
						<button class="btn btn-primary add-new-goals">Add Goal Set</button>
					</form>						
				</div>
				<div id="modal-goal"></div>
				<table class="table table-bordered table-condensed">
					<thead>
						<tr>
							<th>Results range</th>
							<th>Tests/day</th>
							<th>Exercise mins/week</th>
							<th>Long Term</th>
							<th>Achieved by</th>
						</tr>
					</thead>
					<tbody id="goals-list">
					</tbody>
				</table>
					
			</div>
			<div class="tab-pane" id="user-account-tab">
					<div id="profile-saved-message" class="alert alert-success">
						<button type="button" class="close" data-dismiss="alert">×</button>
						Profile Updated
					</div>
                    <div class="row-fluid">
                            <h3>Details</h3>
                            <div class="row-fluid">
                                <div class="span2">
                                     <img <% if(thumbnailPath) { %> src="<%= thumbnailPath %>" <% } %> class="img-polaroid pull-left">
                                </div>
                                <div class="span8">
                                     <p class="lead"><b>Name:</b> <%= name %></p>
                                     <p class="lead"><b>Email:</b> <%= email %></p>
                            
                                    <p class="lead">
                                            <b>Recieve Newsletter?</b> <input type="checkbox" id="newsletter">
                                    </p>
                                    <p class="lead"><b>Result Units:</b>
                                        <select name="account-testing-units" id="account-testing-units">
                                            <option value="mg/dl">mg/dl</option>
                                            <option value="mmol/l">mmol/l</option>
                                        </select>
                                    </p>
                                    <button id="save-profile" class="btn btn-large">Update Details</button>
                                </div>
                            </div>

                        </div>
                        <div class="row-fluid">
                            <h3>Actions</h3>
                             <div class="row-fluid">
                                <div class="span2">
                                    <button id="upload-results" class="btn btn-large btn-block" type="button"><i class="icon-upload-alt"></i> Upload My Results</button>
                                </div>
                                <div class="span8">
                                    <p class="lead">Upload your results from a CareLink csv file to your logbook.</p>
                                </div>    
                        </div>
                        <div class="row-fluid">
                            <h3>Help</h3>
                            <div class="row-fluid">
                                <div class="span2">
                                     <a class="btn btn-large btn-block" href="mailto:jamie@almservices.co.nz"><i class="icon-envelope"></i> Email Jamie</a>  
                                </div>
                                <div class="span8">
                                    <p class="lead">Do you need help with anything?</p>
                                </div>
                           </div>
				</div>
		</div>
		</script>
		<script type="text/template" id="login-template">
		<div id="login-dialog" class="modal hide fade">
			<div class="modal-header">
				<h3>Sign</h3>
			</div>
			<div class="modal-body">
                	
				<button id="login-fb" class="btn btn-block btn-primary btn-large"><i class="icon-facebook icon-large"></i> Login with Facebook</button>
                <button id="login-google" class="btn btn-block btn-primary btn-large"><i class="icon-google-plus icon-large"></i> Login with Google</button>
					
            </div>	
			<div class="modal-footer">
				<button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
			</div>
		</div>
		</script>
        
        <script type="text/javascript" src="js/vendor/jquery-1.8.2.min.js"></script>
        <script type="text/javascript" src="js/vendor/underscore-min.js"></script>
        <script type="text/javascript" src="js/vendor/backbone-min.js"></script>
        <script type="text/javascript" src="js/vendor/backbone.oauth.js"></script>
        <script type="text/javascript" src="js/vendor/backbone_offline.js"></script>
        <script type="text/javascript" src="js/vendor/bootstrap.min.js"></script>
        <script type="text/javascript" src="js/vendor/d3.v2.min.js"></script>
		<script type="text/javascript" src="js/models/Entry.js"></script>
		<script type="text/javascript" src="js/models/User.js"></script>
		<script type="text/javascript" src="js/models/Goal.js"></script>
		
		<script type="text/javascript" src="js/views/AccountView.js"></script>
		<script type="text/javascript" src="js/views/AddGoalsView.js"></script>
		<script type="text/javascript" src="js/views/AddLogbookEntryView.js"></script>
		<script type="text/javascript" src="js/views/EditLogbookEntryView.js"></script>
		<script type="text/javascript" src="js/views/GoalsView.js"></script>
		<script type="text/javascript" src="js/views/LogbookEntryView.js"></script>
		<script type="text/javascript" src="js/views/LogbookEntryView.js"></script>
		<script type="text/javascript" src="js/views/LogbookView.js"></script>
		<script type="text/javascript" src="js/views/LoginView.js"></script>
		<script type="text/javascript" src="js/views/NavigationView.js"></script>
		
        <script type="text/javascript" src="js/main.js"></script>
        <script>
            var hash=window.location.hash;
            window.close();
            if(opener != null){
                opener.OAuthRedirect(hash);
            }
        </script>
	</body>
</html>